<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Live USD to Naira Rate</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      body { font-family: sans-serif; background: #f7fafb; color: #234; padding: 2em; }
      .box { max-width: 370px; margin: 2em auto; padding: 1.5em; background: #fff; border-radius: 8px; box-shadow: 0 2px 10px #0001; }
      h2 { text-align: center; color: #166a39; }
      .rate-row { margin: 1.2em 0; font-size: 1.2em; }
      .label { font-weight: 600; }
      #refresh { margin: 0.8em auto 0 auto; display: block; background: #166a39; color: #fff; border: none; padding: 0.55em 1.3em; border-radius: 6px; cursor: pointer; }
    </style>
  </head>
  <body>
    <div class="box">
      <h2>Live USD to Naira Rate</h2>
      <div class="rate-row"><span class="label">USD Buy Rate:</span> <b id="usdbuy">Loading...</b></div>
      <div class="rate-row"><span class="label">USD Sell Rate:</span> <b id="usdsell">Loading...</b></div>
      <button id="refresh" type="button">Refresh Now</button>
      <div style="color:#7c8; font-size:0.98em; margin-top:1em; text-align:center;">
        Updates automatically every 60 seconds.
      </div>
    </div>
    <script>
      const apiUrl = "https://apli-apl-6795.mtndatasales.workers.dev/api/latest-rates";
      function fetchRates() {
        fetch(apiUrl)
          .then(res => res.json())
          .then(json => {
            // Adapt to your API response structure:
            // Option 1: { data: { USD_NGN: { buy: ..., sell: ... } } }
            // Option 2: { USD_NGN: { buy: ..., sell: ... }, ... }
            const usd = json?.data?.USD_NGN || json?.USD_NGN;
            if (usd) {
              document.getElementById("usdbuy").textContent = usd.buy ? `₦${usd.buy}` : "N/A";
              document.getElementById("usdsell").textContent = usd.sell ? `₦${usd.sell}` : "N/A";
            } else {
              document.getElementById("usdbuy").textContent = "N/A";
              document.getElementById("usdsell").textContent = "N/A";
            }
          })
          .catch(err => {
            document.getElementById("usdbuy").textContent = "Error";
            document.getElementById("usdsell").textContent = "Error";
            console.error("Fetch failed:", err);
          });
      }

      document.getElementById("refresh").onclick = fetchRates;

      window.addEventListener("DOMContentLoaded", () => {
        fetchRates();
        setInterval(fetchRates, 60000); // Update every 60 seconds
      });
    </script>
  </body>
</html>

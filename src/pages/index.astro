---
import "../styles/global.css";

const currencies = [
  { code: "USD_NGN", label: "Dollar", flag: "ğŸ‡ºğŸ‡¸", name: "USD" },
  { code: "GBP_NGN", label: "Pound", flag: "ğŸ‡¬ğŸ‡§", name: "GBP" },
  { code: "EUR_NGN", label: "Euro", flag: "ğŸ‡ªğŸ‡º", name: "EUR" },
  { code: "CAD_NGN", label: "Canadian Dollar", flag: "ğŸ‡¨ğŸ‡¦", name: "CAD" },
  { code: "ZAR_NGN", label: "Rand", flag: "ğŸ‡¿ğŸ‡¦", name: "ZAR" },
  { code: "AUD_NGN", label: "Aussie", flag: "ğŸ‡¦ğŸ‡º", name: "AUD" },
  { code: "AED_NGN", label: "Dirham", flag: "ğŸ‡¦ğŸ‡ª", name: "AED" },
  { code: "CNY_NGN", label: "Yuan", flag: "ğŸ‡¨ğŸ‡³", name: "CNY" },
  { code: "GHS_NGN", label: "Cedi", flag: "ğŸ‡¬ğŸ‡­", name: "GHS" },
  { code: "XOF_NGN", label: "XOF", flag: "ğŸŒ", name: "XOF" },
  { code: "XAF_NGN", label: "XAF", flag: "ğŸŒ", name: "XAF" },
];

let rates = {};
try {
  const res = await fetch("https://astro-blog-starter-template.mtndatasales.workers.dev/api/latest-rates");
  rates = await res.json();
} catch (e) {
  rates = {};
}

// --- Generate conversion table for USD/NGN ---
const usdSellRate = rates.USD_NGN?.sell;
const usdTableRows = [];
for (let i = 1; i <= 100; i++) {
  usdTableRows.push({
    amount: i,
    result: typeof usdSellRate === "number" ? (i * usdSellRate).toLocaleString() : "N/A"
  });
}
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Nairatoday - Live Black Market Exchange Rates</title>
    <meta name="description" content="Track naira black market exchange rate: Dollar, Euro, Pound, and more to Naira. Live rates, daily updates." />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/src/styles/global.css">
  </head>
  <body>
    <div class="header">
      <h1>Dollar To Naira Black Market Exchange Rate Today</h1>
      <div class="subtitle">Live rates for Dollar, Pound, Euro, and more</div>
    </div>

    <div class="cards">
      {currencies.map(({ code, label, flag, name }) => (
        <div class="card" key={code}>
          <div class="flag">{flag}</div>
          <div class="label">{label} ({name})</div>
          <div class="rate-row"><b>BUY</b> = â‚¦{rates[code]?.buy ?? 'N/A'}</div>
          <div class="rate-row"><b>SELL</b> = â‚¦{rates[code]?.sell ?? 'N/A'}</div>
        </div>
      ))}
    </div>
    <div class="welcome-box">
      <h2>Welcome to Nairatoday.com</h2>
      <p>Your trusted source for real-time updates on the Dollar to Naira Black Market exchange rate. We provide accurate, up-to-date information to help you stay informed and make smarter financial decisions.</p>
    </div>

    <!-- Dollar to Naira Conversion Table -->
    <div class="usd-convert-box" style="margin:2em 0;">
      <h2>Quick Dollar (USD) to Naira Converter Table</h2>
      <table class="calc-table">
        <thead>
          <tr>
            <th>Amount (USD)</th>
            <th>Equivalent (â‚¦)</th>
          </tr>
        </thead>
        <tbody>
          {usdTableRows.map(row => (
            <tr>
              <td>{row.amount}</td>
              <td>â‚¦{row.result}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  </body>
</html>
